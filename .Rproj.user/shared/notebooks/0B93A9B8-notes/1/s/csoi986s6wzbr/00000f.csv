"0","caff.marital <- matrix(c(652, 1537, 598, 242, 36, 46,"
"0","    38, 21, 218, 327, 106, 67), nrow = 3, byrow = T)"
"0","colnames(caff.marital) <- c(""0"", ""1-150"", ""151-300"","
"0","    "">300"")"
"0","rownames(caff.marital) <- c(""Married"", ""Prev.married"","
"0","    ""Single"")"
"0",""
"0","mychisq <- function(obs1){"
"0","N <- sum(obs1)"
"0","r <- dim(obs1)[1]"
"0","c <- dim(obs1)[2]"
"0","rowS <- apply(obs1, 1, sum)"
"0","colS <- apply(obs1, 2, sum)"
"0",""
"0","rowS"
"0",""
"0","expCt <- as.matrix(rowS,ncol=1)%*%colS/N"
"0","expCt"
"0",""
"0","if(r==2&c==2){"
"0","  chisq.stat <- sum((abs(obs1-expCt)-0.5)^2 / expCt)"
"0","} else chisq.stat <- sum((obs1-expCt)^2/expCt)"
"0",""
"0","pv <- pchisq(chisq.stat, df=(r-1)*(c-1), lower.tail = FALSE)"
"0","return (list(stat=chisq.stat,pvalue =pv))"
"0","}"
"0","mychisq(obs1)"
"2","Error in mychisq(obs1) : object 'obs1' not found
"
