"0","determine_tests <- function(df) {"
"0","  n_groups <- length(unique(df$group))"
"0","  pv1 <- rep(NA, ncol(df)) # Initialize vector with NAs"
"0","  tests <- rep("""", ncol(df)) # Initialize vector with empty strings"
"0","  if (is.numeric(df[,2])) {"
"0","    if (n_groups > 2) {"
"0","      for (i in 1:ncol(df)) {"
"0","        sp<-c()"
"0","        fp<-c()"
"0","        for (j in 1:n_groups) {"
"0","          sp[j] <- shapiro.test(df[df$group==j,i+1])$p.value"
"0","          if (j > 1 ) {"
"0","            fp[j-1] <-var.test(df[df$group==(j-1),i+1],df[df$group==j,i+1])$p.value"
"0","          }"
"0","          if(all(sp > 0.05) & all(fp > 0.05)) {"
"0","            test <- anova(df[,i+1]~group, data=df)$p.value"
"0","            pv1[i] <- summary(test)[[1]][[""Pr(>F)""]][[1]]"
"0","            tests[i] <- ""anova"""
"0","          } else {"
"0","            pv1[i] <- kruskal.test(df[,i+1]~group,data=df)$p.value"
"0","            tests[i] <- ""kruskal"""
"0","          }"
"0","        }"
"0","      }"
"0","    } else { "
"0","      for (i in 1:ncol(df)) {"
"0","        sp<-c()"
"0","        fp<-c()"
"0","        for (j in 1:n_groups) {"
"0","          sp[j] <- shapiro.test(df[df$group==j,i+1])$p.value"
"0","          if (j > 1 ) {"
"0","            fp[j-1] <-var.test(df[df$group==(j-1),i+1],df[df$group==j,i+1])$p.value"
"0","          }"
"0","          if(all(sp > 0.05) & all(fp > 0.05)) {"
"0","            pv1[i] <- t.test(df[df$group==0,i+1],df[df$group==1,i+1],var.equal=TRUE)$p.value"
"0","            tests[i] <- ""TtestEV"""
"0","          } else if(all(sp>0.05) & all(fp<=0.05)) {"
"0","            pv1[i] <- t.test(df[df$group==0,i+1],df[df$group==1,i+1],var.equal=FALSE)$p.value"
"0","            tests[i] <- 'TtestUEV'"
"0","          } else {"
"0","            pv1[i] <- wilcox.test(df[df$group==0,i+1],df[df$group==1,i+1])$p.value"
"0","            tests[i] <- 'Wilcox'"
"0","          }"
"0","        }"
"0","      }"
"0","    }"
"0","  } else {"
"0","    if (all(table(df$group) >= 20)){"
"0","      for (i in 1:ncol(df)) {"
"0","        chisq <- chisq.test(df[,i+1], df$group)"
"0","        if (chisq$p.value < 0.05) {"
"0","          tests[i] <- ""chisq"""
"0","          pv1[i] <- chisq$p.value"
"0","        } else {"
"0","          tests[i] <- ""Fisher"""
"0","          fisher <- fisher.test(df[,i+1], df$group)"
"0","          pv1[i] <- fisher$p.value"
"0","        }"
"0","      }"
"0","    } "
"0","  }"
"0","  return(list(pvalue = pv1, test= tests))"
"0","}"
