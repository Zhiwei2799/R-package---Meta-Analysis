"0","determine_tests <- function(df) {"
"0","  n_groups <- length(unique(df$group))"
"0","  pv1 <- c(0,c())"
"0","  tests <- c()"
"0","  if (is.numeric(df[,2])) {"
"0","    if (n_groups > 2) {"
"0","      for (i in 2:ncol(df)) { "
"0","        sp <- c()"
"0","        fp <- c()"
"0","        for (j in 1:n_groups) {"
"0","          sp[j] <- shapiro.test(df[df$group==j,i])$p.value"
"0","          if (j > 1) {"
"0","            fp[j-1] <- var.test(df[df$group==(j-1),i], df[df$group==j,i])$p.value "
"0","          }"
"0","        }"
"0","        if(all(sp > 0.05) & all(fp > 0.05)) {"
"0","          test <- aov(df[,i]~group, data=df)"
"0","          pv1[i] <- summary(test)[[1]][[""Pr(>F)""]][[1]]"
"0","          tests[i-1] <- ""anova""  "
"0","        } else {"
"0","          pv1[i] <- kruskal.test(df[,i]~group,data=df)$p.value  "
"0","          tests[i-1] <- ""kruskal""  "
"0","        }"
"0","      }"
"0","    } else { "
"0","      for (i in 2:ncol(df)) { "
"0","        sp1 <- shapiro.test(df[df$group==1,i])$p.value"
"0","        sp2 <- shapiro.test(df[df$group==2,i])$p.value"
"0","        fp <- var.test(df[df$group==1,i],df[df$group==2,i])$p.value"
"0","        if(sp1>0.05&sp2>0.05&fp>0.05){"
"0","          pv1[i] <- t.test(df[df$group==1,i],df[df$group==2,i],var.equal=TRUE)$p.value"
"0","          tests[i-1] <- 'TtestEV'"
"0","        } else if(sp1>0.05&sp2>0.05&fp<=0.05){"
"0","          pv1[i] <- t.test(df[df$group==1,i],df[df$group==2,i],var.equal=FALSE)$p.value"
"0","          tests[i-1] <- 'TtestUEV'"
"0","        } else {"
"0","          pv1[i] <- wilcox.test(df[df$group==1,i],df[df$group==2,i+2])$p.value"
"0","          tests[i-1] <- 'Wilcox'"
"0","        }"
"0","      }"
"0","    }"
"0","  } else {"
"0","    if (all(table(df$group) >= 20)){"
"0","      for (i in 2:ncol(df)) {"
"0","        chisq <- chisq.test(df[,i], df$group)"
"0","        if (chisq$p.value < 0.05) {"
"0","          tests[i-1] <- ""chisq"""
"0","          pv1[i-1] <- chisq$p.value"
"0","        } else {"
"0","          tests[i-1] <- ""Fisher"""
"0","          fisher <- fisher.test(df[,i], df$group, simulate.p.value=TRUE)"
"0","          pv1[i-1] <- fisher$p.value"
"0","        }"
"0","      }"
"0","    } "
"0","  }"
"0","  return(list(pvalue = pv1, test= tests))"
"0","}"
"0",""
